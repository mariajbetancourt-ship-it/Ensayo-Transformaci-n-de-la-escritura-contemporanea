<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>De la Carta al Chat</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600;700&family=DM+Sans:wght@400;500;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100%;
            background: linear-gradient(to bottom, #9B7EBD 0%, #FFDAB9 100%);
            font-family: Arial, sans-serif;
            position: relative;
            overflow-x: hidden;
        }

        .seccion-intro {
            height: 100vh;
            position: relative;
            overflow: hidden;
        }

        .seccion-contenido {
            min-height: 700vh;
            background: linear-gradient(to bottom, 
                #FFDAB9 0%, 
                #FFDAB9 60%, 
                #F5C9A8 70%,
                #E5B098 75%,
                #D49888 80%,
                #C07F78 85%,
                #A86068 90%,
                #8F4858 95%,
                #6B2C3E 100%
            );
            position: relative;
            transition: background 0.8s ease;
        }

        .seccion-genealogia {
            min-height: 100vh;
            background: linear-gradient(to bottom,
                #6B2C3E 0%,
                #68332D 5%,
                #65392A 10%,
                #623F28 15%,
                #5F4327 20%,
                #5C4728 25%,
                #5A4929 30%,
                #584929 35%,
                #564929 40%,
                #544829 45%,
                #524729 50%,
                #504529 55%,
                #4E4329 60%,
                #4C4129 65%,
                #4A3F29 70%,
                #483D29 75%,
                #463B28 80%,
                #443928 85%,
                #423727 90%,
                #403526 95%,
                #3E3325 100%
            );
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 5%;
        }

        .texto-genealogia {
            text-align: center;
            line-height: 0.9;
            position: relative;
        }

        .texto-genealogia .linea {
            display: block;
            font-size: 12rem;
            font-weight: 600;
            color: #FFDAB9;
            text-transform: uppercase;
            font-family: 'Cormorant Garamond', serif;
            letter-spacing: -0.02em;
            position: relative;
            z-index: 10;
        }

        .imagen-genealogia {
            width: 80%;
            max-width: 800px;
            height: auto;
            margin-top: -20%;
            display: block;
            margin-left: auto;
            margin-right: auto;
            position: relative;
            z-index: 1;
        }

        .seccion-titulo-soportes {
            min-height: 120vh;
            background: #3E3325;
            position: relative;
        }

        .seccion-imagenes {
            min-height: 900vh;
            background: #3E3325;
            position: relative;
        }

        .contenedor-titulo-sticky {
            position: sticky;
            top: 0;
            height: 50vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 5%;
            z-index: 5;
        }

        .titulo-soportes {
            font-size: 4rem;
            font-weight: 600;
            color: #FFDAB9;
            text-align: center;
            font-family: 'Cormorant Garamond', serif;
            letter-spacing: 0.05em;
            line-height: 1.3;
            max-width: 1200px;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .contenedor-imagen {
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.85);
            width: 100%;
            height: 100vh;
            opacity: 0;
            transition: none;
            z-index: 10;
        }

        .imagen-fondo {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .cuadro-cristal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) translateY(100px);
            width: 70%;
            max-width: 900px;
            min-height: 500px;
            background: rgba(80, 70, 60, 0.45);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border-radius: 30px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4),
                        inset 0 0 60px rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: none;
            padding: 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }

        .cuadro-telegrafo {
            background: rgba(120, 120, 120, 0.45);
        }

        .texto-carta {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.8rem;
            line-height: 1.8;
            color: #FFFFFF;
            text-align: center;
            font-weight: 500;
            width: 100%;
            position: relative;
            z-index: 101;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        .texto-carta .cursor {
            display: inline-block;
            width: 2px;
            height: 1.2em;
            background-color: #FFFFFF;
            margin-left: 2px;
            animation: parpadeo 0.8s infinite;
            vertical-align: text-bottom;
        }

        .texto-email {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.5rem;
            line-height: 1.6;
            color: #000000;
            text-align: left;
            font-weight: 400;
            width: 100%;
            position: absolute;
            top: 35%;
            left: 50%;
            transform: translateX(-50%);
            padding: 0 15%;
            z-index: 101;
            opacity: 0;
        }

        .texto-email .cursor {
            display: inline-block;
            width: 2px;
            height: 1.2em;
            background-color: #000000;
            margin-left: 2px;
            animation: parpadeo 0.8s infinite;
            vertical-align: text-bottom;
        }

        @keyframes parpadeo {
            0%, 49% { opacity: 1; }
            50%, 100% { opacity: 0; }
        }

        .texto-container {
            position: sticky;
            top: 0;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 10%;
        }

        .texto-parrafo {
            position: absolute;
            font-size: 2rem;
            line-height: 1.8;
            color: #000000;
            text-align: center;
            max-width: 1000px;
            opacity: 0;
            transform: scale(0.85);
            transition: none;
            font-family: 'Cormorant Garamond', serif;
            font-weight: 400;
        }

        .texto-parrafo.ultimo {
            position: relative;
            opacity: 0;
            transform: scale(0.85);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        .letra {
            position: absolute;
            font-size: 1100px;
            font-weight: bold;
            color: rgba(255, 218, 185, 0.9);
            text-shadow: 2px 2px 10px rgba(0,0,0,0.2);
            pointer-events: none;
        }

        .letra-what {
            font-size: 950px;
            position: absolute;
            transition: none;
            will-change: transform, opacity;
            pointer-events: none;
        }

        .cesta {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 70%;
            background: linear-gradient(to bottom, 
                rgba(255, 218, 185, 0) 0%, 
                rgba(255, 218, 185, 0.7) 40%,
                rgba(255, 218, 185, 1) 100%
            );
            pointer-events: none;
            z-index: 5;
        }

        .titulo {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 5rem;
            color: #000000;
            text-align: center;
            z-index: 10;
            font-weight: 700;
            font-family: 'DM Sans', sans-serif;
            text-transform: uppercase;
            white-space: nowrap;
            animation: zoomOut 0.4s ease-out 2.3s forwards;
        }

        .titulo span {
            display: inline-block;
            opacity: 0;
            filter: blur(15px);
            animation: morphInSitio 1.3s ease-out forwards;
        }

        .titulo .espacio {
            width: 0.5em;
        }

        .subtitulo {
            position: absolute;
            top: calc(50% - 110px);
            left: 50%;
            transform: translate(-50%, 0);
            transform-origin: top center;
            font-size: 4.1rem;
            color: #000000;
            text-align: center;
            z-index: 10;
            font-weight: 700;
            font-family: 'DM Sans', sans-serif;
            text-transform: uppercase;
            line-height: 1.1;
            white-space: nowrap;
        }

        .subtitulo .linea1 {
            display: block;
            opacity: 0;
            animation: subirDesdeAbajo 0.8s ease-out 2.7s forwards;
        }

        .subtitulo .linea2 {
            display: block;
            opacity: 0;
            animation: subirDesdeAbajo 0.8s ease-out 2.85s forwards;
        }

        @keyframes morphInSitio {
            0% {
                opacity: 0;
                filter: blur(15px);
                transform: scale(0.5) rotate(var(--rotate));
            }
            50% {
                opacity: 0.6;
                filter: blur(8px);
                transform: scale(1.2) rotate(0deg);
            }
            100% {
                opacity: 1;
                filter: blur(0px);
                transform: scale(1) rotate(0deg);
            }
        }

        @keyframes zoomOut {
            0% {
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                transform: translate(-50%, -200%) scale(0.35);
            }
        }

        @keyframes subirDesdeAbajo {
            0% {
                opacity: 0;
                transform: translateY(50px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .seccion-3d {
            position: relative;
            width: 100%;
            min-height: 100vh;
            background: #664C73;
            transition: none;
            /* Allow overlay to extend beyond the 3D section so it can be scrolled
               vertically while the 3D canvas moves with the page. */
            overflow: visible;
        }

        .seccion-3d.minimizado {
            /* Cuando se minimiza, la secci√≥n debe crecer para cubrir el overlay expandido */
            min-height: 925vh;
        }

        #canvas3d {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            transition: all 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 1000;
        }

        .seccion-3d.minimizado #canvas3d {
            transform: scale(0.75) translateY(-30%);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 999;
        }

        .overlay-3d {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            z-index: 1002;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.8s ease 0.6s;
            overflow: hidden;
        }

        .seccion-3d.minimizado .overlay-3d {
            opacity: 1;
            pointer-events: auto;
            /* The overlay becomes taller than the viewport and allows scrolling.
               It remains visually above the 3D canvas but scrolls together with the page. */
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            min-height: 925vh; /* expand the overlay so it can be scrolled */
            overflow-y: auto;
            z-index: 1100;
            background: transparent; /* transparent so 3D object remains visible */
        }

        .seccion-3d.overlay-cerrado .overlay-3d {
            opacity: 0;
            pointer-events: none;
        }

        .seccion-3d.overlay-cerrado #canvas3d {
            transform: scale(1) translateY(0);
        }

        /* Asegurar que al no tener clase, el canvas est√© en estado inicial */
        .seccion-3d:not(.minimizado):not(.overlay-cerrado) #canvas3d {
            transform: scale(1) translateY(0);
        }

        .titulo-fragmentacion {
            position: absolute;
            top: 34vh;
            left: 50%;
            transform: translateX(-50%);
            font-size: 3rem;
            font-weight: 600;
            color: #FFDAB9;
            text-align: center;
            font-family: 'Cormorant Garamond', serif;
            letter-spacing: 0.05em;
            line-height: 1.3;
            text-transform: uppercase;
            z-index: 1004;
            pointer-events: none;
        }

        .boton-cerrar {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: rgba(255, 218, 185, 0.2);
            border: 2px solid #FFDAB9;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.5rem;
            color: #FFDAB9;
            transition: all 0.3s ease;
            z-index: 1005;
        }

        .boton-cerrar:hover {
            background: rgba(255, 218, 185, 0.4);
            transform: scale(1.1);
        }

        .chat-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1003;
            pointer-events: none;
        }

        .mensaje-burbuja {
            position: absolute;
            max-width: 30%;
            padding: 15px 20px;
            border-radius: 18px;
            font-family: 'Poppins', sans-serif;
            font-size: 1.1rem;
            line-height: 1.5;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            word-wrap: break-word;
            word-break: break-word;
            white-space: normal;
            will-change: top, opacity;
        }

        .mensaje-enviado {
            right: 30%;
            background: #F48FB1;
            color: #000000;
        }

        .mensaje-recibido {
            left: 30%;
            background: #FFFFFF;
            color: #000000;
        }

        .estrella {
            position: absolute;
            background: #FFDAB9;
            border-radius: 50%;
            opacity: 0;
            pointer-events: none;
            animation: brillar 3s ease-in-out infinite;
            z-index: 1001;
        }

        @keyframes brillar {
            0%, 100% {
                opacity: 0;
                transform: scale(0);
            }
            50% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .destello {
            position: absolute;
            width: 2px;
            height: 2px;
            background: #FFDAB9;
            border-radius: 50%;
            box-shadow: 0 0 10px #FFDAB9, 0 0 20px #FFDAB9, 0 0 30px #FFDAB9;
            opacity: 0;
            pointer-events: none;
            z-index: 1001;
        }

        .seccion-3d.minimizado .estrella,
        .seccion-3d.minimizado .destello {
            opacity: 1;
            animation: brillar 3s ease-in-out infinite;
            position: fixed;
        }

        .ripple {
            position: absolute;
            top: 20%;
            right: 42%;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 3px solid #25D366;
            opacity: 0;
            animation: rippleEffect 2.5s ease-out 2s infinite;
            pointer-events: none;
            z-index: 1155;
        }

        .notificacion-whatsapp {
            position: absolute;
            top: 20%;
            right: 42%;
            width: 100px;
            height: auto;
            z-index: 1150;
            opacity: 0;
            transform: scale(0) translateY(-20px);
            animation: notificacionEntrada 1s ease-out 0.5s forwards, 
                       notificacionPulso 2s ease-in-out 1.5s infinite;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .dedo-pointer {
            position: absolute;
            top: 25%;
            right: 40%;
            font-size: 3rem;
            z-index: 1160;
            opacity: 0;
            animation: dedoClick 2s ease-in-out 3s infinite;
            pointer-events: none;
        }

        .ripple:nth-child(2) {
            animation-delay: 2.8s;
        }

        .ripple:nth-child(3) {
            animation-delay: 3.6s;
        }

        @keyframes rippleEffect {
            0% {
                transform: scale(0.8);
                opacity: 0;
            }
            10% {
                opacity: 0.8;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        @keyframes dedoClick {
            0%, 100% {
                opacity: 0;
                transform: translateY(0) scale(1);
            }
            10% {
                opacity: 1;
            }
            50% {
                transform: translateY(10px) scale(0.9);
                opacity: 1;
            }
            60% {
                transform: translateY(0) scale(1);
            }
            90% {
                opacity: 1;
            }
        }

        @keyframes notificacionEntrada {
            0% {
                opacity: 0;
                transform: scale(0) translateY(-20px);
            }
            50% {
                opacity: 1;
                transform: scale(1.2) translateY(0);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        @keyframes notificacionPulso {
            0%, 100% {
                transform: scale(1) translateY(0);
            }
            50% {
                transform: scale(1.05) translateY(-3px);
            }
        }

        @media (max-width: 1200px) {
            .texto-genealogia .linea {
                font-size: 8rem;
            }
        }

        @media (max-width: 768px) {
            .texto-genealogia .linea {
                font-size: 5rem;
            }
        }

        .seccion-creditos {
            min-height: 100vh;
            background: linear-gradient(to bottom, #664C73 0%, #3E3325 100%);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 5%;
            margin-top: 1240.5vh;
        }

        .contenedor-creditos {
            text-align: center;
            max-width: 800px;
        }

        .creditos-nombre {
            font-family: 'Cormorant Garamond', serif;
            font-size: 4rem;
            font-weight: 600;
            color: #FFDAB9;
            margin-bottom: 2rem;
            letter-spacing: 0.05em;
        }

        .creditos-ensayo {
            font-family: 'Poppins', sans-serif;
            font-size: 1.5rem;
            font-weight: 400;
            color: #F48FB1;
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        .creditos-materia {
            font-family: 'DM Sans', sans-serif;
            font-size: 1.2rem;
            font-weight: 500;
            color: #FFDAB9;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .boton-volver {
            margin-top: 3rem;
            padding: 15px 40px;
            background: rgba(255, 218, 185, 0.2);
            border: 2px solid #FFDAB9;
            border-radius: 30px;
            color: #FFDAB9;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .boton-volver:hover {
            background: rgba(255, 218, 185, 0.4);
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="seccion-intro">
        <div class="cesta"></div>
        <div class="titulo" id="titulo"></div>
        <div class="subtitulo">
            <span class="linea1">WHATSAPP Y LA TRANSFORMACI√ìN</span>
            <span class="linea2">DE LA ESCRITURA CONTEMPOR√ÅNEA</span>
        </div>
    </div>

    <div class="seccion-contenido" id="seccion-contenido">
        <div class="texto-container">
            <div class="texto-parrafo" id="parrafo-1">
                En 1850, comunicarse por escrito a distancia implicaba un proceso deliberado, conseguir papel y tinta, componer cuidadosamente un mensaje, sellarlo y enviarlo. D√≠as despu√©s, el destinatario recib√≠a esas palabras escritas en el pasado. En 2024, ese mismo acto comunicativo ocurre en segundos, se escribe un mensaje fragmentado, se presiona enviar, y la respuesta llega casi instant√°neamente.
            </div>
            <div class="texto-parrafo" id="parrafo-2">
                Representa un cambio fundamental en lo que significa escribir, leer y comunicarse a trav√©s del lenguaje escrito.
            </div>
            <div class="texto-parrafo" id="parrafo-3">
                La historia de la escritura es inseparable de la historia de sus soportes materiales. Cada tecnolog√≠a de inscripci√≥n, tablilla de arcilla, papiro, pergamino, papel impreso, pantalla digital, no solo transmite contenidos, sino que configura las posibilidades mismas de expresi√≥n.
            </div>
            <div class="texto-parrafo" id="parrafo-4">
                Como argumenta Marshall McLuhan, el medio no es un canal neutral: "las consecuencias individuales y sociales de cualquier medio resultan de la nueva escala, ritmo o patrones que introduce en nuestros asuntos" (McLuhan, 1964, p. 23).
            </div>
            <div class="texto-parrafo" id="parrafo-5">
                Este ensayo analiza WhatsApp como un momento paradigm√°tico en la transformaci√≥n de los soportes de escritura. Con m√°s de 2 mil millones de usuarios activos, esta plataforma de mensajer√≠a instant√°nea representa el desplazamiento de la escritura como composici√≥n deliberada hacia la escritura como flujo conversacional.
            </div>
            <div class="texto-parrafo ultimo" id="parrafo-6">
                A trav√©s de los marcos te√≥ricos de Jacques Derrida sobre la cr√≠tica al logocentrismo y de Marshall McLuhan sobre los medios como extensiones del ser humano, se argumentar√° que WhatsApp no es simplemente una nueva herramienta para transmitir mensajes, sino una reconfiguraci√≥n radical de las pr√°cticas de escritura, lectura y autor√≠a en el siglo XXI.
            </div>
        </div>
    </div>

    <div class="seccion-genealogia">
        <div class="texto-genealogia">
            <span class="linea">GENEALOG√çA</span>
            <span class="linea">DE LA</span>
            <span class="linea">ESCRITURA</span>
            <img src="https://i.ibb.co/tyR0STN/T-i-mi-n-ph-Cu-n-S-ch-Ho-t-H-nh-Y-u-T-B-t-L-ng-C-ng-c-h-a-PSD-chuy-n-nghi-p-Pikbest-removebg-preview.png" alt="Genealog√≠a" class="imagen-genealogia">
        </div>
    </div>
    
    <div class="seccion-titulo-soportes">
        <div class="contenedor-titulo-sticky">
            <div class="titulo-soportes">
                UN VIAJE R√ÅPIDO POR LOS SOPORTES DE ESCRITURA
            </div>
        </div>
    </div>

    <div class="seccion-imagenes">
        <div class="contenedor-titulo-sticky">
            <div class="contenedor-imagen contenedor-cartas">
                <img src="https://i.ibb.co/mC4jfdgm/87028178-FF-CARTAS-POSTALES-ANTIGUAS-GENOTAR-SHUTTERSTOCK.jpg" alt="Cartas antiguas" class="imagen-fondo">
                <div class="cuadro-cristal cuadro-cartas">
                    <p class="texto-carta" id="texto-carta"></p>
                </div>
            </div>
            <div class="contenedor-imagen contenedor-telegrafo">
                <img src="https://i.ibb.co/9mBGmFtn/telegrafo-importancia-e1665363134291.jpg" alt="Tel√©grafo" class="imagen-fondo">
                <div class="cuadro-cristal cuadro-telegrafo">
                    <p class="texto-carta" id="texto-telegrafo"></p>
                </div>
            </div>
            <div class="contenedor-imagen contenedor-email">
                <img src="https://i.ibb.co/Z6TjybsH/image.png" alt="Email" class="imagen-fondo">
                <p class="texto-email" id="texto-email"></p>
            </div>
        </div>
    </div>

    <div class="seccion-3d">
        <canvas id="canvas3d"></canvas>
        
        <!-- Overlay que aparece despu√©s de minimizar -->
        <div class="overlay-3d">
            <h2 class="titulo-fragmentacion">LA FRAGMENTACI√ìN<br>DEL MENSAJE</h2>
            <button class="boton-cerrar" id="boton-cerrar-overlay">‚úï</button>
            
            <div class="chat-container" id="chat-container">
                <!-- Los mensajes se generar√°n din√°micamente -->
            </div>
            
            <div class="seccion-creditos">
                <div class="contenedor-creditos">
                    <h1 class="creditos-nombre">Mar√≠a Jos√© Jim√©nez</h1>
                    <p class="creditos-ensayo">Ensayo sobre la transformaci√≥n de los soportes de escritura a lo largo del tiempo</p>
                    <p class="creditos-materia">Narrativa 1</p>
                    <button class="boton-volver" id="boton-volver">Volver al inicio</button>
                </div>
            </div>
        </div>
        
        <!-- Estrellas decorativas - Arriba -->
        <div class="estrella" style="top: 15%; left: 10%; width: 4px; height: 4px; animation-delay: 0s;"></div>
        <div class="estrella" style="top: 20%; left: 25%; width: 3px; height: 3px; animation-delay: 0.5s;"></div>
        <div class="estrella" style="top: 12%; left: 40%; width: 5px; height: 5px; animation-delay: 1s;"></div>
        <div class="estrella" style="top: 18%; left: 55%; width: 4px; height: 4px; animation-delay: 0.3s;"></div>
        <div class="estrella" style="top: 22%; left: 70%; width: 3px; height: 3px; animation-delay: 0.8s;"></div>
        <div class="estrella" style="top: 15%; left: 85%; width: 5px; height: 5px; animation-delay: 1.2s;"></div>
        <div class="estrella" style="top: 10%; left: 95%; width: 4px; height: 4px; animation-delay: 0.6s;"></div>
        
        <!-- Estrellas - Centro Izquierda -->
        <div class="estrella" style="top: 35%; left: 5%; width: 4px; height: 4px; animation-delay: 0s;"></div>
        <div class="estrella" style="top: 42%; left: 12%; width: 3px; height: 3px; animation-delay: 0.5s;"></div>
        <div class="estrella" style="top: 55%; left: 8%; width: 5px; height: 5px; animation-delay: 1s;"></div>
        
        <!-- Estrellas - Centro Derecha -->
        <div class="estrella" style="top: 38%; left: 88%; width: 4px; height: 4px; animation-delay: 0.3s;"></div>
        <div class="estrella" style="top: 50%; left: 92%; width: 3px; height: 3px; animation-delay: 0.8s;"></div>
        <div class="estrella" style="top: 58%; left: 95%; width: 5px; height: 5px; animation-delay: 1.2s;"></div>
        
        <!-- Estrellas - Abajo -->
        <div class="estrella" style="top: 75%; left: 15%; width: 4px; height: 4px; animation-delay: 0.4s;"></div>
        <div class="estrella" style="top: 82%; left: 30%; width: 3px; height: 3px; animation-delay: 0.9s;"></div>
        <div class="estrella" style="top: 78%; left: 45%; width: 5px; height: 5px; animation-delay: 1.3s;"></div>
        <div class="estrella" style="top: 85%; left: 60%; width: 4px; height: 4px; animation-delay: 0.7s;"></div>
        <div class="estrella" style="top: 80%; left: 75%; width: 3px; height: 3px; animation-delay: 1.1s;"></div>
        <div class="estrella" style="top: 88%; left: 90%; width: 5px; height: 5px; animation-delay: 0.2s;"></div>
        
        <!-- Destellos m√°s peque√±os - Distribuidos por toda la pantalla -->
        <div class="destello" style="top: 25%; left: 18%; animation-delay: 0.2s;"></div>
        <div class="destello" style="top: 30%; left: 32%; animation-delay: 0.7s;"></div>
        <div class="destello" style="top: 28%; left: 48%; animation-delay: 1.5s;"></div>
        <div class="destello" style="top: 32%; left: 65%; animation-delay: 0.4s;"></div>
        <div class="destello" style="top: 27%; left: 78%; animation-delay: 0.9s;"></div>
        <div class="destello" style="top: 33%; left: 92%; animation-delay: 1.3s;"></div>
        
        <div class="destello" style="top: 45%; left: 20%; animation-delay: 0.6s;"></div>
        <div class="destello" style="top: 48%; left: 35%; animation-delay: 1.1s;"></div>
        <div class="destello" style="top: 52%; left: 65%; animation-delay: 0.3s;"></div>
        <div class="destello" style="top: 55%; left: 80%; animation-delay: 0.8s;"></div>
        
        <div class="destello" style="top: 68%; left: 10%; animation-delay: 0.5s;"></div>
        <div class="destello" style="top: 72%; left: 25%; animation-delay: 1s;"></div>
        <div class="destello" style="top: 70%; left: 38%; animation-delay: 0.2s;"></div>
        <div class="destello" style="top: 73%; left: 52%; animation-delay: 0.7s;"></div>
        <div class="destello" style="top: 69%; left: 68%; animation-delay: 1.2s;"></div>
        <div class="destello" style="top: 74%; left: 82%; animation-delay: 0.4s;"></div>
        <div class="destello" style="top: 71%; left: 95%; animation-delay: 0.9s;"></div>
        
        <!-- M√°s destellos dispersos -->
        <div class="destello" style="top: 18%; left: 5%; animation-delay: 0.8s;"></div>
        <div class="destello" style="top: 14%; left: 62%; animation-delay: 1.4s;"></div>
        <div class="destello" style="top: 36%; left: 50%; animation-delay: 0.6s;"></div>
        <div class="destello" style="top: 62%; left: 50%; animation-delay: 1.1s;"></div>
        <div class="destello" style="top: 40%; left: 3%; animation-delay: 1.3s;"></div>
        <div class="destello" style="top: 60%; left: 97%; animation-delay: 0.5s;"></div>
        <div class="destello" style="top: 90%; left: 20%; animation-delay: 0.3s;"></div>
        <div class="destello" style="top: 92%; left: 50%; animation-delay: 1s;"></div>
        <div class="destello" style="top: 88%; left: 72%; animation-delay: 0.7s;"></div>
        
        <div class="ripple"></div>
        <div class="ripple"></div>
        <div class="ripple"></div>
        <img src="https://i.ibb.co/ymxw7YtF/images-artguru-removebg-preview-1-artguru-removebg-preview.png" alt="Notificaci√≥n" class="notificacion-whatsapp" id="notificacion">
        <div class="dedo-pointer">üëÜ</div>
    </div>

    <script type="module">
        import { Application } from 'https://unpkg.com/@splinetool/runtime@1.0.0/build/runtime.js';
        
        let app = null;
        let canvas3dLoaded = false;
        
        function cargarCanvas3D() {
            if (canvas3dLoaded) return;
            
            const canvas = document.getElementById('canvas3d');
            
            // Usar requestIdleCallback para cargar en momentos de inactividad
            const loadCanvas = () => {
                app = new Application(canvas);
                app.load('https://prod.spline.design/S0fp9mpviaxpHa25/scene.splinecode')
                    .then(() => {
                        console.log('Canvas 3D cargado');
                        canvas3dLoaded = true;
                    })
                    .catch(err => console.error('Error cargando canvas:', err));
            };
            
            if ('requestIdleCallback' in window) {
                requestIdleCallback(loadCanvas, { timeout: 1000 });
            } else {
                setTimeout(loadCanvas, 0);
            }
        }
        
        // Observer para cargar el canvas solo cuando est√© cerca
        const seccion3d = document.querySelector('.seccion-3d');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    cargarCanvas3D();
                    observer.unobserve(entry.target);
                }
            });
        }, {
            rootMargin: '100px' // Cargar 100px antes de llegar
        });
        
        if (seccion3d) {
            observer.observe(seccion3d);
        }
    </script>

    <script>
        // Forzar scroll al inicio al cargar la p√°gina
        window.addEventListener('load', function() {
            setTimeout(function() {
                window.scrollTo(0, 0);
            }, 0);
        });

        if (history.scrollRestoration) {
            history.scrollRestoration = 'manual';
        }

        // Scroll al inicio al recargar
        window.addEventListener('beforeunload', function() {
            window.scrollTo(0, 0);
        });
        window.escrituraIniciada = false;
        window.escrituraTelegrafoIniciada = false;
        window.escrituraEmailIniciada = false;

        const letrasApp = [
            { texto: 'A', x: -5, delay: 0 },
            { texto: 'p', x: 35, delay: 500 },
            { texto: 'p', x: 65, delay: 1000 }
        ];

        const letrasWhat = [
            { texto: 'W', x: 5, delay: 2500, id: 'letra-w' },
            { texto: 'h', x: 30, delay: 3000, id: 'letra-h' },
            { texto: 'a', x: 55, delay: 3500, id: 'letra-a' },
            { texto: 't', x: 80, delay: 4000, id: 'letra-t' }
        ];

        const letrasWhatElements = {};

        function crearLetraCayendo(config) {
            setTimeout(() => {
                const letra = document.createElement('div');
                letra.className = 'letra';
                letra.textContent = config.texto;
                letra.style.left = config.x + '%';
                letra.style.top = '-1500px';
                letra.style.transformOrigin = 'center center';
                document.body.appendChild(letra);

                let posY = -1500;
                const velocidad = 100;
                
                let rotacion = (Math.random() - 0.5) * 30;
                const velocidadRotacion = (Math.random() - 0.5) * 4;
                
                let posX = config.x;
                const deriva = (Math.random() - 0.5) * 0.2;

                function animar() {
                    posY += velocidad;
                    rotacion += velocidadRotacion;
                    posX += deriva;
                    
                    letra.style.top = posY + 'px';
                    letra.style.left = posX + '%';
                    letra.style.transform = `rotate(${rotacion}deg)`;

                    if (posY < window.innerHeight + 200) {
                        requestAnimationFrame(animar);
                    } else {
                        letra.remove();
                    }
                }

                animar();
            }, config.delay);
        }

        function crearLetraDetenida(config) {
            setTimeout(() => {
                const letra = document.createElement('div');
                letra.className = 'letra letra-what';
                letra.id = config.id;
                letra.textContent = config.texto;
                letra.style.transformOrigin = 'center center';
                document.body.appendChild(letra);

                letrasWhatElements[config.id] = {
                    element: letra,
                    initialX: config.x,
                    initialTop: 0,
                    finalRotation: 0,
                    finalPosX: config.x
                };

                let posY = -1500;
                const velocidad = 100;
                const posicionFinal = window.innerHeight * 0.5 - 475;
                
                let rotacion = (Math.random() - 0.5) * 30;
                const velocidadRotacion = (Math.random() - 0.5) * 4;
                
                let posX = config.x;
                const deriva = (Math.random() - 0.5) * 0.2;

                function animar() {
                    if (posY < posicionFinal) {
                        posY += velocidad;
                        rotacion += velocidadRotacion;
                        posX += deriva;
                        
                        letra.style.top = posY + 'px';
                        letra.style.left = posX + '%';
                        letra.style.transform = `rotate(${rotacion}deg)`;
                        requestAnimationFrame(animar);
                    } else {
                        letra.style.top = posicionFinal + 'px';
                        letra.style.left = posX + '%';
                        letra.style.transform = `rotate(${rotacion}deg)`;
                        
                        letrasWhatElements[config.id].finalRotation = rotacion;
                        letrasWhatElements[config.id].initialTop = posicionFinal;
                        letrasWhatElements[config.id].finalPosX = posX;
                    }
                }

                animar();
            }, config.delay);
        }

        function animarTitulo() {
            const titulo = document.getElementById('titulo');
            const palabras = ['DE', 'LA', 'CARTA', 'AL', 'CHAT'];
            
            const rotaciones = [
                '-180deg', '180deg', '-90deg', '90deg', '-270deg', '270deg',
                '-120deg', '120deg', '-150deg', '150deg', '-200deg', '200deg',
                '-45deg', '45deg', '-135deg', '135deg', '-225deg', '225deg'
            ];
            
            let letraIndex = 0;
            
            palabras.forEach((palabra, palabraIndex) => {
                for (let i = 0; i < palabra.length; i++) {
                    const span = document.createElement('span');
                    span.textContent = palabra[i];
                    
                    const rotacion = rotaciones[letraIndex % rotaciones.length];
                    span.style.setProperty('--rotate', rotacion);
                    
                    span.style.animationDelay = `${Math.random() * 1}s`;
                    
                    titulo.appendChild(span);
                    letraIndex++;
                }
                
                if (palabraIndex < palabras.length - 1) {
                    const espacio = document.createElement('span');
                    espacio.className = 'espacio';
                    espacio.innerHTML = '&nbsp;';
                    espacio.style.opacity = '1';
                    titulo.appendChild(espacio);
                }
            });
        }

        const parrafos = [
            { id: 'parrafo-1', start: 0, end: 100 },
            { id: 'parrafo-2', start: 100, end: 200 },
            { id: 'parrafo-3', start: 200, end: 300 },
            { id: 'parrafo-4', start: 300, end: 400 },
            { id: 'parrafo-5', start: 400, end: 500 },
            { id: 'parrafo-6', start: 500, end: 600 }
        ];

        function handleTextoTransition() {
            const scrollY = window.scrollY;
            const introHeight = window.innerHeight;
            
            const scrollEnContenido = Math.max(0, (scrollY - introHeight) / window.innerHeight * 100);

            parrafos.forEach((parrafo) => {
                const elemento = document.getElementById(parrafo.id);
                
                if (parrafo.id === 'parrafo-6') {
                    if (scrollEnContenido >= parrafo.start) {
                        const fadeInRange = 50;
                        const fadeInProgress = Math.min((scrollEnContenido - parrafo.start) / fadeInRange, 1);
                        elemento.style.opacity = fadeInProgress;
                        elemento.style.transform = `scale(${0.85 + (fadeInProgress * 0.15)})`;
                    } else {
                        elemento.style.opacity = 0;
                        elemento.style.transform = 'scale(0.85)';
                    }
                } else {
                    if (scrollEnContenido >= parrafo.start && scrollEnContenido <= parrafo.end) {
                        const rangoTotal = parrafo.end - parrafo.start;
                        const progressInRange = (scrollEnContenido - parrafo.start) / rangoTotal;
                        
                        if (progressInRange < 0.2) {
                            const fadeInProgress = progressInRange / 0.2;
                            elemento.style.opacity = fadeInProgress;
                            elemento.style.transform = `scale(${0.85 + (fadeInProgress * 0.15)})`;
                        } else if (progressInRange < 0.8) {
                            elemento.style.opacity = 1;
                            elemento.style.transform = 'scale(1)';
                        } else {
                            const fadeOutProgress = (progressInRange - 0.8) / 0.2;
                            elemento.style.opacity = 1 - fadeOutProgress;
                            elemento.style.transform = `scale(${1 + (fadeOutProgress * 0.15)})`;
                        }
                    } else {
                        elemento.style.opacity = 0;
                        if (scrollEnContenido < parrafo.start) {
                            elemento.style.transform = 'scale(0.85)';
                        } else {
                            elemento.style.transform = 'scale(1.15)';
                        }
                    }
                }
            });
        }

        function handleScroll() {
            const scrollY = window.scrollY;
            const introHeight = window.innerHeight;
            const maxScroll = introHeight;
            const progress = Math.min(scrollY / maxScroll, 1);

            if (scrollY < introHeight) {
                if (letrasWhatElements['letra-w']) {
                    const el = letrasWhatElements['letra-w'];
                    const newLeft = el.finalPosX - (progress * 60);
                    const newTop = el.initialTop - (scrollY * 1.5) - (progress * 500);
                    el.element.style.left = newLeft + '%';
                    el.element.style.top = newTop + 'px';
                    el.element.style.transform = `rotate(${el.finalRotation}deg)`;
                    el.element.style.opacity = 1 - progress;
                }

                if (letrasWhatElements['letra-h']) {
                    const el = letrasWhatElements['letra-h'];
                    const newLeft = el.finalPosX - (progress * 40);
                    const newTop = el.initialTop - (scrollY * 1.3) - (progress * 300);
                    el.element.style.left = newLeft + '%';
                    el.element.style.top = newTop + 'px';
                    el.element.style.transform = `rotate(${el.finalRotation}deg)`;
                    el.element.style.opacity = 1 - progress;
                }

                if (letrasWhatElements['letra-a']) {
                    const el = letrasWhatElements['letra-a'];
                    const newLeft = el.finalPosX + (progress * 15);
                    const newTop = el.initialTop - (scrollY * 1.2) - (progress * 200);
                    el.element.style.left = newLeft + '%';
                    el.element.style.top = newTop + 'px';
                    el.element.style.transform = `rotate(${el.finalRotation}deg)`;
                    el.element.style.opacity = 1 - progress;
                }

                if (letrasWhatElements['letra-t']) {
                    const el = letrasWhatElements['letra-t'];
                    const newLeft = el.finalPosX + (progress * 50);
                    const newTop = el.initialTop - (scrollY * 1.4) - (progress * 400);
                    el.element.style.left = newLeft + '%';
                    el.element.style.top = newTop + 'px';
                    el.element.style.transform = `rotate(${el.finalRotation}deg)`;
                    el.element.style.opacity = 1 - progress;
                }
            }

            handleTextoTransition();
        }
        
        function animarTituloSoportes() {
            const seccionSoportes = document.querySelector('.seccion-titulo-soportes');
            const tituloSoportes = document.querySelector('.titulo-soportes');
            
            if (seccionSoportes && tituloSoportes) {
                const scrollY = window.scrollY;
                const seccionTop = seccionSoportes.offsetTop;
                const windowHeight = window.innerHeight;
                
                const scrollEnSeccion = Math.max(0, (scrollY - seccionTop) / windowHeight * 100);
                
                // Comportamiento igual a los p√°rrafos anteriores
                if (scrollEnSeccion < 20) {
                    // Fade in
                    const fadeInProgress = scrollEnSeccion / 20;
                    tituloSoportes.style.opacity = fadeInProgress;
                    tituloSoportes.style.transform = `scale(${0.85 + (fadeInProgress * 0.15)})`;
                } else if (scrollEnSeccion >= 20 && scrollEnSeccion < 80) {
                    // Visible al 100%
                    tituloSoportes.style.opacity = 1;
                    tituloSoportes.style.transform = 'scale(1)';
                } else if (scrollEnSeccion >= 80 && scrollEnSeccion <= 100) {
                    // Fade out
                    const fadeOutProgress = (scrollEnSeccion - 80) / 20;
                    tituloSoportes.style.opacity = 1 - fadeOutProgress;
                    tituloSoportes.style.transform = `scale(${1 + (fadeOutProgress * 0.15)})`;
                } else {
                    // Oculto
                    tituloSoportes.style.opacity = 0;
                    tituloSoportes.style.transform = 'scale(1.15)';
                }
            }
        }

        const imagenes = [
            { 
                contenedor: '.contenedor-cartas', 
                cuadro: '.cuadro-cartas',
                texto: 'texto-carta',
                iniciarEscritura: () => iniciarEscritura(),
                flagEscritura: 'escrituraIniciada',
                start: 0, 
                end: 300 
            },
            { 
                contenedor: '.contenedor-telegrafo', 
                cuadro: '.cuadro-telegrafo',
                texto: 'texto-telegrafo',
                iniciarEscritura: () => iniciarEscrituraTelegrafo(),
                flagEscritura: 'escrituraTelegrafoIniciada',
                start: 300, 
                end: 600 
            },
            { 
                contenedor: '.contenedor-email', 
                cuadro: null,
                texto: 'texto-email',
                iniciarEscritura: () => iniciarEscrituraEmail(),
                flagEscritura: 'escrituraEmailIniciada',
                start: 600, 
                end: 900 
            }
        ];

        function animarImagenes() {
            const seccionImagenes = document.querySelector('.seccion-imagenes');
            if (!seccionImagenes) return;

            const scrollY = window.scrollY;
            const seccionTop = seccionImagenes.offsetTop;
            const windowHeight = window.innerHeight;
            
            const scrollEnSeccion = Math.max(0, (scrollY - seccionTop) / windowHeight * 100);

            imagenes.forEach((imagen) => {
                const contenedor = document.querySelector(imagen.contenedor);
                const cuadroElement = imagen.cuadro ? document.querySelector(imagen.cuadro) : null;
                const textoElement = document.getElementById(imagen.texto);
                
                if (!contenedor) return;

                if (scrollEnSeccion >= imagen.start && scrollEnSeccion <= imagen.end) {
                    const rangoTotal = imagen.end - imagen.start;
                    const progressInRange = (scrollEnSeccion - imagen.start) / rangoTotal;
                    
                    if (progressInRange < 0.2) {
                        const fadeInProgress = progressInRange / 0.2;
                        contenedor.style.opacity = fadeInProgress;
                        contenedor.style.transform = `translate(-50%, -50%) scale(${0.85 + (fadeInProgress * 0.15)})`;
                        
                        if (cuadroElement) {
                            cuadroElement.style.opacity = 0;
                            cuadroElement.style.transform = 'translate(-50%, -50%) translateY(100px)';
                        }
                        if (textoElement && !cuadroElement) {
                            textoElement.style.opacity = 0;
                        }
                    } else if (progressInRange < 0.8) {
                        contenedor.style.opacity = 1;
                        contenedor.style.transform = 'translate(-50%, -50%) scale(1)';
                        
                        if (progressInRange >= 0.3 && progressInRange < 0.5) {
                            const elementProgress = (progressInRange - 0.3) / 0.2;
                            
                            if (cuadroElement) {
                                const translateY = 100 - (elementProgress * 100);
                                cuadroElement.style.opacity = elementProgress;
                                cuadroElement.style.transform = `translate(-50%, -50%) translateY(${translateY}px)`;
                            }
                            if (textoElement && !cuadroElement) {
                                textoElement.style.opacity = elementProgress;
                            }
                        } else if (progressInRange >= 0.5) {
                            if (cuadroElement) {
                                cuadroElement.style.opacity = 1;
                                cuadroElement.style.transform = 'translate(-50%, -50%) translateY(0)';
                            }
                            if (textoElement && !cuadroElement) {
                                textoElement.style.opacity = 1;
                            }
                        }
                        
                        // Iniciar escritura apenas aparezca la imagen (para email sin cuadro)
                        if (!cuadroElement && progressInRange >= 0.25 && !window[imagen.flagEscritura]) {
                            window[imagen.flagEscritura] = true;
                            imagen.iniciarEscritura();
                        }
                        
                        // Para cartas y tel√©grafo, iniciar cuando el cuadro est√© visible
                        if (cuadroElement && progressInRange >= 0.5 && !window[imagen.flagEscritura]) {
                            window[imagen.flagEscritura] = true;
                            imagen.iniciarEscritura();
                        }
                    } else {
                        const fadeOutProgress = (progressInRange - 0.8) / 0.2;
                        contenedor.style.opacity = 1 - fadeOutProgress;
                        contenedor.style.transform = `translate(-50%, -50%) scale(${1 + (fadeOutProgress * 0.15)})`;
                    }
                } else {
                    contenedor.style.opacity = 0;
                    if (scrollEnSeccion < imagen.start) {
                        contenedor.style.transform = 'translate(-50%, -50%) scale(0.85)';
                    } else {
                        contenedor.style.transform = 'translate(-50%, -50%) scale(1.15)';
                    }
                }
            });
        }
        
        function iniciarEscritura() {
            const textoCarta = document.getElementById('texto-carta');
            const textoCompleto = 'Durante siglos, escribir a distancia significaba la carta. Un acto deliberado que requer√≠a papel, tinta, composici√≥n cuidadosa. Una vez sellada, era irrevocable. Se guardaba en cajones como objeto f√≠sico, como archivo tangible de un pasado que no pod√≠as modificar. La carta configuraba una escritura consciente de su permanencia.';
            
            let indice = 0;
            const velocidad = 40;
            
            function escribir() {
                if (indice < textoCompleto.length) {
                    textoCarta.textContent = textoCompleto.substring(0, indice + 1);
                    
                    const cursor = document.createElement('span');
                    cursor.className = 'cursor';
                    textoCarta.appendChild(cursor);
                    
                    indice++;
                    setTimeout(escribir, velocidad);
                } else {
                    setTimeout(() => {
                        const cursor = textoCarta.querySelector('.cursor');
                        if (cursor) cursor.remove();
                    }, 2000);
                }
            }
            
            escribir();
        }

        function iniciarEscrituraTelegrafo() {
            const textoTelegrafo = document.getElementById('texto-telegrafo');
            const textoCompleto = 'El tel√©grafo en 1844 introduce la primera ruptura real. De repente pod√≠as transmitir texto a velocidad casi instant√°nea. Pero cada palabra costaba, entonces naci√≥ la sintaxis telegr√°fica, Escritura condensada, esencial, sin adornos.';
            
            let indice = 0;
            const velocidad = 40;
            
            function escribir() {
                if (indice < textoCompleto.length) {
                    textoTelegrafo.textContent = textoCompleto.substring(0, indice + 1);
                    
                    const cursor = document.createElement('span');
                    cursor.className = 'cursor';
                    textoTelegrafo.appendChild(cursor);
                    
                    indice++;
                    setTimeout(escribir, velocidad);
                } else {
                    setTimeout(() => {
                        const cursor = textoTelegrafo.querySelector('.cursor');
                        if (cursor) cursor.remove();
                    }, 2000);
                }
            }
            
            escribir();
        }

        function iniciarEscrituraEmail() {
            const textoEmail = document.getElementById('texto-email');
            const textoCompleto = 'El email en los a√±os 90 digitaliza el soporte pero conserva la estructura epistolar. Saludo, cuerpo, despedida, firma. M√°s r√°pido que la carta f√≠sica, pero mentalmente funciona igual. Compones un mensaje completo, lo revisas, lo env√≠as.';
            
            let indice = 0;
            const velocidad = 40;
            
            // Usar setInterval en lugar de setTimeout recursivo para que contin√∫e autom√°ticamente
            const intervalo = setInterval(() => {
                if (indice < textoCompleto.length) {
                    textoEmail.textContent = textoCompleto.substring(0, indice + 1);
                    
                    const cursor = document.createElement('span');
                    cursor.className = 'cursor';
                    textoEmail.appendChild(cursor);
                    
                    indice++;
                } else {
                    clearInterval(intervalo);
                    setTimeout(() => {
                        const cursor = textoEmail.querySelector('.cursor');
                        if (cursor) cursor.remove();
                    }, 2000);
                }
            }, velocidad);
        }
        
        window.addEventListener('scroll', function() {
            handleScroll();
            animarTituloSoportes();
            animarImagenes();
        });

        letrasApp.forEach(config => crearLetraCayendo(config));
        letrasWhat.forEach(config => crearLetraDetenida(config));
        animarTitulo();

        const notificacion = document.getElementById('notificacion');
        const seccion3dEl = document.querySelector('.seccion-3d');
        const botonCerrar = document.getElementById('boton-cerrar-overlay');
        const chatContainer = document.getElementById('chat-container');
        
        // Mensajes del chat
        const mensajes = [
            { texto: "oye entonces qu√© tiene de especial whatsapp?", tipo: "recibido", scrollOffset: 50 },
            { texto: "al final es solo otra app no?", tipo: "recibido", scrollOffset: 150 },
            { texto: "mira c√≥mo acabas de escribir eso", tipo: "enviado", scrollOffset: 250 },
            { texto: "???", tipo: "recibido", scrollOffset: 350 },
            { texto: "dos mensajes", tipo: "enviado", scrollOffset: 450 },
            { texto: "podr√≠as haber escrito todo junto", tipo: "enviado", scrollOffset: 550 },
            { texto: "pero lo fragmentaste", tipo: "enviado", scrollOffset: 650 },
            { texto: "no me di cuenta jajaja", tipo: "recibido", scrollOffset: 750 },
            { texto: "exacto", tipo: "enviado", scrollOffset: 850 },
            { texto: "antes escrib√≠as UN mensaje completo", tipo: "enviado", scrollOffset: 950 },
            { texto: "Hola, espero que est√©s bien. Quer√≠a saber si tienes tiempo esta semana. Saludos", tipo: "enviado", scrollOffset: 1050 },
            { texto: "muy formal", tipo: "recibido", scrollOffset: 1150 },
            { texto: "ahora:", tipo: "enviado", scrollOffset: 1250 },
            { texto: "hola, tienes tiempo? esta semana?", tipo: "enviado", scrollOffset: 1350 },
            { texto: "ya no compongo el mensaje", tipo: "recibido", scrollOffset: 1450 },
            { texto: "escribes mientras piensas", tipo: "enviado", scrollOffset: 1550 },
            { texto: "y lo del escribiendo...?", tipo: "recibido", scrollOffset: 1650 },
            { texto: "eso me pone ansioso a veces?", tipo: "recibido", scrollOffset: 1750 },
            { texto: "claro porque ahora el proceso de escritura es visible", tipo: "enviado", scrollOffset: 1850 },
            { texto: "antes escribir era privado hasta que enviaras", tipo: "enviado", scrollOffset: 1950 },
            { texto: "ahora el otro puede ver que est√°s escribiendo antes de que decidas qu√© decir", tipo: "enviado", scrollOffset: 2050 },
            { texto: "y cuando desaparece sin que llegue nada", tipo: "recibido", scrollOffset: 2150 },
            { texto: "pienso: se arrepinti√≥? cambi√≥ de opini√≥n?", tipo: "recibido", scrollOffset: 2250 },
            { texto: "el silencio significa algo ahora", tipo: "enviado", scrollOffset: 2350 },
            { texto: "Marshall McLuhan dir√≠a: el medio es el mensaje", tipo: "enviado", scrollOffset: 2450 },
            { texto: "no entiendo", tipo: "recibido", scrollOffset: 2550 },
            { texto: "whatsapp no solo transmite conversaciones", tipo: "enviado", scrollOffset: 2650 },
            { texto: "crea un tipo nuevo de estar juntos", tipo: "enviado", scrollOffset: 2750 },
            { texto: "a ver dame un ejemplo", tipo: "recibido", scrollOffset: 2850 },
            { texto: "ok mira", tipo: "enviado", scrollOffset: 2950 },
            { texto: "ok", tipo: "enviado", scrollOffset: 3050 },
            { texto: "suena cortante", tipo: "recibido", scrollOffset: 3150 },
            { texto: "ok üòä", tipo: "enviado", scrollOffset: 3250 },
            { texto: "ah ya es amable", tipo: "recibido", scrollOffset: 3350 },
            { texto: "el emoji contiene", tipo: "enviado", scrollOffset: 3450 },
            { texto: "o sea que las im√°genes tambi√©n escriben", tipo: "recibido", scrollOffset: 3550 },
            { texto: "un emoji dice cosas que tres p√°rrafos no podr√≠an", tipo: "enviado", scrollOffset: 3650 },
            { texto: "nunca lo hab√≠a pensado as√≠", tipo: "recibido", scrollOffset: 3750 },
            { texto: "Jacques Derrida trabaj√≥ toda su vida en esto", tipo: "enviado", scrollOffset: 3850 },
            { texto: "desmontar la idea de que hablar es m√°s real que escribir", tipo: "enviado", scrollOffset: 3950 },
            { texto: "y?", tipo: "recibido", scrollOffset: 4050 },
            { texto: "whatsapp hace que esa distinci√≥n ya no tenga sentido", tipo: "enviado", scrollOffset: 4150 },
            { texto: "escribimos como hablamos:jajaja, uffff", tipo: "enviado", scrollOffset: 4250 },
            { texto: "y las notas de voz?", tipo: "recibido", scrollOffset: 4350 },
            { texto: "es habla pero queda registrada", tipo: "enviado", scrollOffset: 4450 },
            { texto: "entonces es habla o escritura", tipo: "recibido", scrollOffset: 4550 },
            { texto: "la pregunta ya no funciona", tipo: "enviado", scrollOffset: 4650 },
            { texto: "Este mensaje fue eliminado", tipo: "enviado", scrollOffset: 4750 },
            { texto: "ESA FRASE", tipo: "recibido", scrollOffset: 4850 },
            { texto: "me da m√°s curiosidad que cualquier mensaje real", tipo: "recibido", scrollOffset: 4950 },
            { texto: "exacto", tipo: "enviado", scrollOffset: 5050 },
            { texto: "Derrida lo llamar√≠a \"huella\"", tipo: "enviado", scrollOffset: 5150 },
            { texto: "el mensaje ya no est√°, pero hay una marca", tipo: "recibido", scrollOffset: 5250 },
            { texto: "que decia? por que lo borraron? ", tipo: "recibido", scrollOffset: 5350 },
            { texto: "nunca lo vas a saber", tipo: "enviado", scrollOffset: 5450 },
            { texto: "y esa imposibilidad es lo que lo hace significante", tipo: "enviado", scrollOffset: 5550 },
            { texto: "es como los recuerdos", tipo: "recibido", scrollOffset: 5650 },
            { texto: "exactamente", tipo: "enviado", scrollOffset: 5750 },
            { texto: "sabemos que algo pas√≥", tipo: "enviado", scrollOffset: 5850 },
            { texto: "pero los detalles se borraron", tipo: "enviado", scrollOffset: 5950 },
            { texto: "y no podemos recuperar lo que realmente pas√≥?", tipo: "recibido", scrollOffset: 6050 },
            { texto: "Elizabeth Loftus demostr√≥ que los recuerdos se modifican cada vez que los evocamos", tipo: "enviado", scrollOffset: 6150 },
            { texto: "las emociones del presente reescriben los recuerdos", tipo: "enviado", scrollOffset: 6250 },
            { texto: "los recuerdos no son fijos, se reescribe constantemente", tipo: "enviado", scrollOffset: 6350 },
            { texto: "como whatsapp", tipo: "recibido", scrollOffset: 6450 },
            { texto: "puedes editar borrar transformar", tipo: "recibido", scrollOffset: 6550 },
            { texto: "exacto", tipo: "enviado", scrollOffset: 6650 },
            { texto: "ok entonces", tipo: "recibido", scrollOffset: 6750 },
            { texto: "whatsapp no es solo una app", tipo: "recibido", scrollOffset: 6850 },
            { texto: "no", tipo: "enviado", scrollOffset: 6950 },
            { texto: "es una forma completamente nueva de escribir", tipo: "recibido", scrollOffset: 7050 },
            { texto: "de leer, de estar presente", tipo: "enviado", scrollOffset: 7150 },
            { texto: "y de recordar", tipo: "recibido", scrollOffset: 7250 },
            { texto: "exacto üòä", tipo: "enviado", scrollOffset: 7350 },
            



        ];
        
        // Crear burbujas de mensajes
        function crearMensajes() {
            let acumuladoTop = 7; // Comenzar en 7% (cerca del t√≠tulo en 7vh)
            
            mensajes.forEach((mensaje, index) => {
                const burbuja = document.createElement('div');
                burbuja.className = `mensaje-burbuja mensaje-${mensaje.tipo}`;
                burbuja.textContent = mensaje.texto;
                burbuja.dataset.scrollOffset = mensaje.scrollOffset;
                burbuja.dataset.index = index;
                burbuja.style.top = acumuladoTop + '%';
                
                chatContainer.appendChild(burbuja);
                
                // Calcular la altura aproximada del mensaje basado en su longitud
                // Si es corto (menos de 40 caracteres), usar espaciado fijo de 1.5%
                if (mensaje.texto.length <= 40) {
                    acumuladoTop += 1.5;
                } else {
                    // Para mensajes largos, calcular altura din√°mica
                    const caracteresEstimadosPorLinea = 35;
                    const numLineas = Math.ceil(mensaje.texto.length / caracteresEstimadosPorLinea);
                    const alturaEstimada = (numLineas * 0.6) + 0.5;
                    acumuladoTop += alturaEstimada + 0.5;
                }
            });
        }
        
        // Actualizar posici√≥n de mensajes seg√∫n scroll
        function actualizarPosicionMensajes() {
            if (!seccion3dEl.classList.contains('minimizado')) return;
            
            const seccionTop = seccion3dEl.offsetTop;
            const scrollY = window.scrollY;
            
            // Calcular cu√°nto scroll hemos hecho dentro de la secci√≥n
            const scrollDentroSeccion = Math.max(0, scrollY - seccionTop);
            
            const burbujas = chatContainer.querySelectorAll('.mensaje-burbuja');
            
            burbujas.forEach((burbuja, index) => {
                const scrollOffset = parseInt(burbuja.dataset.scrollOffset);
                
                // Calcular cu√°ndo debe aparecer el mensaje
                if (scrollDentroSeccion >= scrollOffset) {
                    // El mensaje debe aparecer
                    const distanciaRecorrida = scrollDentroSeccion - scrollOffset;
                    
                    // Posici√≥n inicial: 100% (abajo), va subiendo hasta 10%
                    const posicionBase = 100 - (index * 12); // Espaciado entre mensajes
                    const movimiento = distanciaRecorrida * 0.15; // Velocidad de subida
                    const posicionFinal = Math.max(10, posicionBase - movimiento);
                    
                    burbuja.style.top = posicionFinal + '%';
                    
                    // Hacer visible si est√° en rango visible (entre 10% y 90%)
                    if (posicionFinal <= 85 && posicionFinal >= 10) {
                        burbuja.classList.add('visible');
                    } else {
                        burbuja.classList.remove('visible');
                    }
                } else {
                    // El mensaje a√∫n no debe aparecer
                    burbuja.style.top = '100%';
                    burbuja.classList.remove('visible');
                }
            });
        }
        
        if (notificacion) {
            notificacion.addEventListener('click', function() {
                document.querySelectorAll('.ripple, .dedo-pointer').forEach(el => {
                    el.style.display = 'none';
                });
                
                this.style.animation = 'none';
                this.style.transform = 'scale(0.9)';
                
                setTimeout(() => {
                    this.style.opacity = '0';
                    this.style.transform = 'scale(0)';
                    
                    if (seccion3dEl) {
                        seccion3dEl.classList.add('minimizado');
                        seccion3dEl.classList.remove('overlay-cerrado');
                        
                        // Crear mensajes cuando se abre el overlay
                        if (chatContainer.children.length === 0) {
                            crearMensajes();
                        }
                        
                        // Scroll autom√°tico a la secci√≥n 3D
                        setTimeout(() => {
                            const seccionTop = seccion3dEl.offsetTop;
                            window.scrollTo(0, seccionTop);
                            
                            // Prevenir scroll hacia arriba de manera continua
                            const preventScrollHandler = function() {
                                if (seccion3dEl.classList.contains('minimizado')) {
                                    const currentScroll = window.scrollY;
                                    if (currentScroll < seccionTop) {
                                        window.scrollTo(0, seccionTop);
                                    }
                                }
                            };
                            
                            window.addEventListener('scroll', preventScrollHandler, { passive: false });
                            
                            // Guardar referencia para remover despu√©s
                            window.scrollBlockHandler = preventScrollHandler;
                        }, 200);
                    }
                }, 150);
            });
        }

        // Manejar el bot√≥n de cerrar overlay
        if (botonCerrar) {
            botonCerrar.addEventListener('click', function() {
                if (seccion3dEl) {
                    seccion3dEl.classList.remove('minimizado');
                    seccion3dEl.classList.add('overlay-cerrado');
                    
                    // Remover el bloqueo de scroll
                    if (window.scrollBlockHandler) {
                        window.removeEventListener('scroll', window.scrollBlockHandler);
                        window.scrollBlockHandler = null;
                    }
                    
                    // Restaurar la notificaci√≥n para que se pueda volver a abrir
                    if (notificacion) {
                        notificacion.style.opacity = '1';
                        notificacion.style.transform = 'scale(1)';
                        notificacion.style.animation = 'notificacionEntrada 1s ease-out 0.5s forwards, notificacionPulso 2s ease-in-out 1.5s infinite';
                    }
                    
                    // Mostrar ripple y dedo otra vez
                    document.querySelectorAll('.ripple, .dedo-pointer').forEach(el => {
                        el.style.display = 'block';
                    });
                }
            });
        }

        // Detectar si la secci√≥n 3D est√° visible en el viewport
        function checkSeccion3dVisibility() {
            if (!seccion3dEl) return;

            // Original behavior: reset overlay if the section is no longer visible

            const rect = seccion3dEl.getBoundingClientRect();
            const windowHeight = window.innerHeight;

            // Si la secci√≥n ya no est√° visible en el viewport
            if (rect.bottom < 0 || rect.top > windowHeight) {
                // Resetear todo al estado inicial
                seccion3dEl.classList.remove('minimizado');
                seccion3dEl.classList.remove('overlay-cerrado');

                // Limpiar mensajes
                if (chatContainer) {
                    chatContainer.innerHTML = '';
                }
            }
        }

        // Escuchar el scroll para verificar visibilidad
        window.addEventListener('scroll', function() {
            checkSeccion3dVisibility();
            // actualizarPosicionMensajes() desactivada para mantener posiciones fijas
        });

        // Bot√≥n volver al inicio desde cr√©ditos
        const botonVolver = document.getElementById('boton-volver');
        if (botonVolver) {
            botonVolver.addEventListener('click', function() {
                // Cerrar overlay
                if (seccion3dEl) {
                    seccion3dEl.classList.remove('minimizado');
                    seccion3dEl.classList.add('overlay-cerrado');
                    
                    if (chatContainer) {
                        chatContainer.innerHTML = '';
                    }
                    
                    // Mostrar notificaci√≥n y animaciones de nuevo
                    if (notificacion) {
                        notificacion.style.opacity = '';
                        notificacion.style.transform = '';
                        notificacion.style.animation = '';
                    }
                    
                    document.querySelectorAll('.ripple, .dedo-pointer').forEach(el => {
                        el.style.display = 'block';
                    });
                }
                
                // Scroll suave al inicio
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }

        // ScrollTrigger removed - restoring default behavior
    </script>
</body>
</html>
